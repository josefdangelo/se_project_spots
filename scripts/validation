const showFieldError = (modalFormElement, fillOutInfo, fieldErrorMessage) => {
  const fieldErrorMessageID = fillOutInfo.id + "-error";
  const fieldErrorBottomMessage = modalFormElement.querySelector(
    "#" + fieldErrorMessageID
  );
  fieldErrorBottomMessage.textContent = fieldErrorMessage;
  fillOutInfo.classList.add(".modal__input_type_error");
};

const hideFieldError = (modalFormElement, fillOutInfo) => {
  const fieldErrorMessageID = fillOutInfo.id + "-error";
  const fieldErrorBottomMessage = modalFormElement.querySelector(
    "#" + fieldErrorMessageID
  );
  fieldErrorBottomMessage.textContent = "";
  fillOutInfo.classList.remove(".modal__input_type_error");
};

const checkInputValidity = (modalFormElement, fillOutInfo) => {
  if (!fillOutInfo.validity.valid) {
    showFieldError(
      modalFormElement,
      fillOutInfo,
      fillOutInfo.validationMessage
    );
  } else {
    hideFieldError(modalFormElement, fillOutInfo);
  }
};

const hasInvalidInput = (fillOutInfoList) => {
  return fillOutInfoList.some((fillOutInfo) => {
    return !fillOutInfo.validity.valid;
  });
};

const toggleButtonState = (fillOutInfoList, saveButtonElement) => {
 if (hasInvalidInput(fillOutInfoList)) {
 disableButton(saveButtonElement);
} else {
  saveButtonElement.disabled = false;
  saveButtonElement.classList.remove("modal__submit-btn-disabled");
}

};

const disableButton = (saveButtonElement) => {
  saveButtonElement.disabled = true;
  saveButtonElement.classList.add("modal__submit-btn-disabled");
}

const resetValidation = (modalFormElement, fillOutInfoList,saveButtonElement) => {
fillOutInfoList.forEach((fillOutInfo) => {
hideFieldError(modalFormElement, fillOutInfo);
disableButton(saveButtonElement);
});
};


const setEventListeners = (modalFormElement) => {
  const fillOutInfoList = Array.from(
    modalFormElement.querySelectorAll(".modal__input")
  );
  const saveButtonElement =
    modalFormElement.querySelector(".modal__submit-btn");

     toggleButtonState(fillOutInfoList, saveButtonElement);

  fillOutInfoList.forEach((fillOutInfo) => {
    fillOutInfo.addEventListener("input", function () {
      checkInputValidity(modalFormElement, fillOutInfo);
      toggleButtonState(fillOutInfoList, saveButtonElement);
    });
  });
};

const enableValidation = () => {
  const modalFormList = document.querySelectorAll(".modal__form");
  modalFormList.forEach((modalFormElement) => {
    setEventListeners(modalFormElement);
  });
};
enableValidation();
