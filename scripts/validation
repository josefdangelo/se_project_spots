const settings = {
  formSelector: ".modal__form",
  inputSelector: ".modal__input",
  submitButtonSelector: ".modal__submit-btn",
  inactiveButtonClass: "modal__submit-btn-disabled",
  inputErrorClass: "modal__input-type-error",
  errorClass: ".modal__error"
};

const showFieldError = (modalFormElement, fillOutInfo, fieldErrorMessage, configuration) => {
  const fieldErrorMessageID = fillOutInfo.id + "-error";
  const fieldErrorBottomMessage = modalFormElement.querySelector(
    "#" + fieldErrorMessageID
  );
  fieldErrorBottomMessage.textContent = fieldErrorMessage;
  fillOutInfo.classList.add(configuration.inputErrorClass);
};

const hideFieldError = (modalFormElement, fillOutInfo, configuration) => {
  const fieldErrorMessageID = fillOutInfo.id + "-error";
  const fieldErrorBottomMessage = modalFormElement.querySelector(
    "#" + fieldErrorMessageID
  );
  fieldErrorBottomMessage.textContent = "";
  fillOutInfo.classList.remove(configuration.inputErrorClass);
};

const checkInputValidity = (modalFormElement, fillOutInfo, configuration) => {
  if (!fillOutInfo.validity.valid) {
    showFieldError(
      modalFormElement,
      fillOutInfo,
      fillOutInfo.validationMessage
    );
  } else {
    hideFieldError(modalFormElement, fillOutInfo, configuration);
  }
};

const hasInvalidInput = (fillOutInfoList) => {
  return fillOutInfoList.some((fillOutInfo) => {
    return !fillOutInfo.validity.valid;
  });
};

const toggleButtonState = (fillOutInfoList, saveButtonElement, configuration) => {
 if (hasInvalidInput(fillOutInfoList)) {
 disableButton(saveButtonElement, configuration);
} else {
  saveButtonElement.disabled = false;
  saveButtonElement.classList.remove(configuration.inactiveButtonClass);
}

};

const disableButton = (saveButtonElement, configuration) => {
  saveButtonElement.disabled = true;
  saveButtonElement.classList.add(configuration.inactiveButtonClass);
}

const resetValidation = (modalFormElement, fillOutInfoList, saveButtonElement) => {
  saveButtonElement.disabled = true;
  modalFormElement.reset();

fillOutInfoList.forEach((fillOutInfo) => {
hideFieldError(modalFormElement, fillOutInfo)
});
};

const setEventListeners = (modalFormElement, configuration) => {
  const fillOutInfoList = Array.from(
    modalFormElement.querySelectorAll(configuration.inputSelector)
  );
  const saveButtonElement =
    modalFormElement.querySelector(configuration.submitButtonSelector);

     toggleButtonState(fillOutInfoList, saveButtonElement, configuration);

  fillOutInfoList.forEach((fillOutInfo) => {
    fillOutInfo.addEventListener("input", function () {
      checkInputValidity(modalFormElement, fillOutInfo, configuration);
      toggleButtonState(fillOutInfoList, saveButtonElement, configuration);
    });
  });
};

const enableValidation = (configuration) => {
  const modalFormList = document.querySelectorAll(configuration.formSelector);
  modalFormList.forEach((modalFormElement) => {
    setEventListeners(modalFormElement, configuration);
  });
};
enableValidation(settings);
